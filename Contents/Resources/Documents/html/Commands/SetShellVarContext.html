<!DOCTYPE html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,shrink-to-fit=no"><meta name=generator content="nsis-docset-builder v0.6.0"><title>SetShellVarContext</title><style>@font-face{font-family:'Fira Sans';src:url(../../fonts/FiraSans-Light.eot);src:local('Fira Sans Light'),url(../../fonts/FiraSans-Light.eot) format('embedded-opentype'),url(../../fonts/FiraSans-Light.woff2) format('woff2'),url(../../fonts/FiraSans-Light.ttf) format('truetype');font-weight:300;font-style:normal;font-display:swap}@font-face{font-family:'Fira Sans';src:url(../../fonts/FiraSans-Regular.eot);src:local('Fira Sans Regular'),url(../../fonts/FiraSans-Regular.eot) format('embedded-opentype'),url(../../fonts/FiraSans-Regular.woff2) format('woff2'),url(../../fonts/FiraSans-Regular.ttf) format('truetype');font-weight:400;font-style:normal;font-display:swap}@font-face{font-family:'Fira Mono';src:url(../../fonts/FiraMono-Regular.eot);src:local('Fira Mono'),url(../../fonts/FiraMono-Regular.eot) format('embedded-opentype'),url(../../fonts/FiraMono-Regular.woff2) format('woff2'),url(../../fonts/FiraMono-Regular.woff) format('woff'),url(../../fonts/FiraMono-Regular.ttf) format('truetype');font-weight:400;font-style:normal;font-display:swap}</style><link rel=stylesheet href=../../css/theme.css><link rel=stylesheet href=../../css/highlight.css></head><body class=font-sans><div class="container mx-auto mt-8"><div class=columns-1><h1 id=setshellvarcontext>SetShellVarContext</h1><p>Sets the context of <a href=../Variables/SMPROGRAMS.html><code>$SMPROGRAMS</code></a> and other shell folders. If set to &#39;current&#39; (the default), the current user&#39;s shell folders are used. If set to &#39;all&#39;, the &#39;all users&#39; shell folder is used. The all users folder may not be supported on all OSes. If the all users folder is not found, the current user folder will be used. Please take into consideration that a &quot;normal user&quot; has no rights to write in the all users area. Only admins have full access rights to the all users area. You can check this by using the UserInfo plug-in. See Contrib\UserInfo\UserInfo.nsi for an example.</p><p>Note that, if used in installer code, this will only affect the installer, and if used in uninstaller code, this will only affect the uninstaller. To affect both, it needs to be used in both.</p><h2 id=parameters>Parameters</h2><pre><code class="hljs language-nsis"><span class=hljs-literal>current</span>|<span class=hljs-literal>all</span>
</code></pre><h2 id=example>Example</h2><pre><code class="hljs language-nsis"><span class=hljs-keyword>SetShellVarContext</span> <span class=hljs-literal>current</span>
<span class=hljs-keyword>StrCpy</span> <span class=hljs-variable>$0</span> <span class=hljs-variable>$DESKTOP</span>
<span class=hljs-keyword>SetShellVarContext</span> <span class=hljs-literal>all</span>
<span class=hljs-keyword>StrCpy</span> <span class=hljs-variable>$1</span> <span class=hljs-variable>$DESKTOP</span>
<span class=hljs-keyword>MessageBox</span> <span class=hljs-params>MB_OK</span> <span class=hljs-variable>$0</span>$\n<span class=hljs-variable>$1</span>
</code></pre><h2 id=history>History</h2><p>Added in NSIS v1.98</p></div><div class="columns-1 text-right"><hr><a href=https://github.com/NSIS-Dev/Documentation/edit/main/docs/Commands/SetShellVarContext.md>Edit on GitHub</a></div></div></body></html>