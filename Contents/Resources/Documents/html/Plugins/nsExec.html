<!DOCTYPE html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,shrink-to-fit=no"><meta name=generator content="nsis-docset-builder v0.6.0"><title>nsExec</title><style>@font-face{font-family:'Fira Sans';src:url(../../fonts/FiraSans-Light.eot);src:local('Fira Sans Light'),url(../../fonts/FiraSans-Light.eot) format('embedded-opentype'),url(../../fonts/FiraSans-Light.woff2) format('woff2'),url(../../fonts/FiraSans-Light.ttf) format('truetype');font-weight:300;font-style:normal;font-display:swap}@font-face{font-family:'Fira Sans';src:url(../../fonts/FiraSans-Regular.eot);src:local('Fira Sans Regular'),url(../../fonts/FiraSans-Regular.eot) format('embedded-opentype'),url(../../fonts/FiraSans-Regular.woff2) format('woff2'),url(../../fonts/FiraSans-Regular.ttf) format('truetype');font-weight:400;font-style:normal;font-display:swap}@font-face{font-family:'Fira Mono';src:url(../../fonts/FiraMono-Regular.eot);src:local('Fira Mono'),url(../../fonts/FiraMono-Regular.eot) format('embedded-opentype'),url(../../fonts/FiraMono-Regular.woff2) format('woff2'),url(../../fonts/FiraMono-Regular.woff) format('woff'),url(../../fonts/FiraMono-Regular.ttf) format('truetype');font-weight:400;font-style:normal;font-display:swap}</style><link rel=stylesheet href=../../css/theme.css><link rel=stylesheet href=../../css/highlight.css></head><body class=font-sans><div class="container mx-auto mt-8"><div class=columns-1><h1 id=nsexec>nsExec</h1><p>nsExec will execute command-line based programs and capture the output without opening a DOS box.</p><h2 id=usage>Usage</h2><pre><code class="hljs language-nsis"><span class="hljs-title function_">nsExec::Exec</span> [/OEM] [/TIMEOUT=x] path
<span class=hljs-keyword>Pop</span> <span class=hljs-variable>$0</span>

<span class="hljs-title function_">nsExec::ExecToLog</span> [/OEM] [/TIMEOUT=x] path
<span class=hljs-keyword>Pop</span> <span class=hljs-variable>$0</span>

<span class="hljs-title function_">nsExec::ExecToStack</span> [/OEM] [/TIMEOUT=x] path
<span class=hljs-keyword>Pop</span> <span class=hljs-variable>$0</span> <span class=hljs-comment>; Return</span>
<span class=hljs-keyword>Pop</span> <span class=hljs-variable>$1</span> <span class=hljs-comment>; Output</span>
</code></pre><p>All functions are the same except <code>ExecToLog</code> will print the output to the log window and <code>ExecToStack</code> will push up to <code>${NSIS_MAX_STRLEN}</code> characters of output onto the stack after the return value.</p><p>Use the /OEM switch to convert the output text from OEM to ANSI.</p><p>The timeout value is optional. The timeout is the time in milliseconds <code>nsExec</code> will wait for output. If output from the process is received, the timeout value is reset and it will again wait for more output using the timeout value. See Return Value for how to check if there was a timeout.</p><p>To ensure that command are executed without problems on all windows versions, is recommended to use the following syntax:</p><pre><code class="hljs language-nsis"><span class="hljs-title function_">nsExec::ExecToStack</span> [OPTIONS] <span class=hljs-string>&#x27;&quot;PATH&quot; param1 param2 paramN&#x27;</span>
</code></pre><p>This way the application path may contain non 8.3 paths (with spaces)</p><h3 id=return-value>Return Value</h3><p>If <code>nsExec</code> is unable to execute the process, it will return &quot;error&quot;on the top of the stack, if the process timed out it will return &quot;timeout&quot;, else it will return the return code from the executed process.</p><h2 id=credits>Credits</h2><p>Written by <a href=http://nsis.sourceforge.net/User:Kichik>Robert Rainwater</a>. Thanks to Justin Frankel and [Amir Szekely][3].</p></div><div class="columns-1 text-right"><hr><a href=https://github.com/NSIS-Dev/Documentation/edit/main/docs/Plugins/nsExec.md>Edit on GitHub</a></div></div></body></html>